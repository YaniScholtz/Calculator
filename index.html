<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scientific Calculator</title>
    <link rel="stylesheet" href="style.css">
    <script>
        function evaluateExpression(expression) {
            /*Declaring a variable to see if it matches with other values */
            let match;

            /*The functions that match must match with. a-z is for the function name like sin or cos and the ^ + is the argument inside*/
            const functionRegex = /([a-zA-Z]+)\(([^)]+)\)/g;

            while (match = functionRegex.exec(expression)) {
                const funcName = match[1]; /*Name is given in the first item*/
                const insideParentheses = match[2]; /*Value inside for example the 25 in sin*/

                let result; /*Store the result from the arithemic you will do*/
                switch (funcName) {
                    case 'sqrt':
                        /*Convers to a number to do the calculation*/
                        result = Math.sqrt(parseFloat(insideParentheses));
                        break;
                    case 'sin':
                        result = Math.sin(parseFloat(insideParentheses));
                        break;
                    case 'cos':
                        result = Math.cos(parseFloat(insideParentheses));
                        break;
                    case 'tan':
                        result = Math.tan(parseFloat(insideParentheses));
                        break;
                    case 'log':
                        result = Math.log10(parseFloat(insideParentheses));
                        break;
                    case 'exp':
                        result = Math.exp(parseFloat(insideParentheses));
                        break;
                    default:
                        result = 0;
                        break;
                }


                expression = expression.replace(match[0], result.toString());
                /*Replaces the expression like sqrt(16) with 4 as a string
                This is to simplify the expression until all the expressions are replaced
                with their result and then just to easy +,x ect*/
            }

            /*Here you split the expression so that you can match if it is a +, - or what type of operator it is*/
            const tokens = expression.split(/([+\-*/^])/).filter(token => token !== '');
            const numberStack = [];
            let i = 0;
            /*Iterate through all of the tojens in the array*/
            while (i < tokens.length) {
                const token = tokens[i];
                /*First do this since it must be worked with before the + and -*/
                if (token === '*' || token === '/' || token === '^') {
                    const operator = token;
                    const operand = tokens[i + 1];
                    /*Get the left hand operand of the calculation*/
                    const leftOperand = numberStack.pop();
                    /*Call operate function to work out the sum*/
                    const result = operate(leftOperand, operand, operator);
                    /*Push the result back onto the stack so that if there are any more 
                    expressions that it can be used*/
                    numberStack.push(result);
                    /*Plus two because it only works with two numbers at a time*/
                    i += 2;
                } else {
                    numberStack.push(token);
                    i++;
                }
            }
            /*Values in numberStack is still stored as strings so you must
            change it to integers first*/

            let result = parseFloat(numberStack[0]);
            /*j+=2 because the even indices are numbers and the odd is operators*/
            for (let j = 1; j < numberStack.length; j += 2) {
                const operator = numberStack[j];
                const operand = parseFloat(numberStack[j + 1]);
                result = operate(result, operand, operator);
            }

            return result;
        }

        function operate(a, b, operator) {
            a = parseFloat(a);
            b = parseFloat(b);
            switch (operator) {
                case '+':
                    return a + b;
                case '-':
                    return a - b;
                case '*':
                    return a * b;
                case '/':
                    return a / b;
                case '^':
                    return Math.pow(a, b);
                default:
                    return 0;
            }
        }

        function handleInput(input, display) {
            if (input === "=") {
                display.value = evaluateExpression(display.value);
            } else if (input === "AC") {
                display.value = "";
            } else if (input === "DE") {
                display.value = display.value.toString().slice(0, -1);
            } else {
                display.value += input;
            }
        }
    </script>
</head>

<body>
    <div class="container">
        <div class="calculator">
            <form>
                <div class="display">
                    <input type="text" name="display">
                </div>
                <div>
                    <input type="button" value="AC" onclick="handleInput('AC',display)" class="operator">
                    <input type="button" value="DE" onclick="handleInput('DE',display)" class="operator">
                    <input type="button" value="." onclick="handleInput('.',display)" class="operator">
                    <input type="button" value="/" onclick="handleInput('/',display)" class="operator">
                </div>
                <div>
                    <input type="button" value="7" onclick="handleInput('7',display)">
                    <input type="button" value="8" onclick="handleInput('8',display)">
                    <input type="button" value="9" onclick="handleInput('9',display)">
                    <input type="button" value="*" onclick="handleInput('*',display)" class="operator">
                </div>
                <div>
                    <input type="button" value="4" onclick="handleInput('4',display)">
                    <input type="button" value="5" onclick="handleInput('5',display)">
                    <input type="button" value="6" onclick="handleInput('6',display)">
                    <input type="button" value="-" onclick="handleInput('-',display)" class="operator">
                </div>
                <div>
                    <input type="button" value="1" onclick="handleInput('1',display)">
                    <input type="button" value="2" onclick="handleInput('2',display)">
                    <input type="button" value="3" onclick="handleInput('3',display)">
                    <input type="button" value="+" onclick="handleInput('+',display)" class="operator">
                </div>
                <div>
                    <input type="button" value="0" onclick="handleInput('00',display)">
                    <input type="button" value="sqrt(" onclick="handleInput('sqrt(',display)">
                    <input type="button" value="sin(" onclick="handleInput('sin(',display)">
                    <input type="button" value="cos(" onclick="handleInput('cos(',display)">

                </div>

                <!-- Scientific Buttons -->
                <div>

                    <input type="button" value="tan(" onclick="handleInput('tan(',display)">
                    <input type="button" value="log(" onclick="handleInput('log(',display)">
                    <input type="button" value="exp(" onclick="handleInput('exp(',display)">
                    <input type="button" value="^" onclick="handleInput('^',display)" class="operator">
                </div>
                <div>
                    <input type="button" value=")" onclick="handleInput(')', display)" class="operator">

                    <input type="button" value="=" onclick="handleInput('=',display)" class="equal operator">


                </div>
            </form>
        </div>
    </div>
</body>

</html>